<!DOCTYPE html>
<html lang="en">

  <head>
  	<meta charset="utf-8" />
  	<meta http-equiv="X-UA-Compatible" content="IE=edge">
  	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>MorTeam</title>
  	<link href='http://fonts.googleapis.com/css?family=Open+Sans:700,300,400' rel='stylesheet' type='text/css'>
  	<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
  	<link href='http://fonts.googleapis.com/css?family=Exo+2:400,300,200' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="css/index.css" type="text/css">
    <link href="jbox/jBox.css" rel="stylesheet">
  </head>
  <body>
      <div id="audio-files" style="display: none;">
          <audio id="click-sound">
              <source src="jbox/audio/bling2.wav" type="audio/wav" />
          </audio>
      </div>
    <!-- NAVIGATION BAR -->
    <div class="nav_dropdown">
      <p onclick="location='index'">Home</p>
      <p onclick="location='chat'">Chat</p>
      <p onclick="location='drive'">Drive</p>
      <p onclick="location='cal'">Calendar</p>
      <p onclick="location='networks'">Networks</p>
    </div>
    <div class="navigation_bar">
        <ul id="navbar_list">
          <li class="navbar_item navbar_title" onclick="location='index'">
              MorTeam
          </li>
          <li class="navbar_item searchbox_list_item">
              <input type="text" placeholder="search" class="searchbox"></input>
          </li>
          <li class="navbar_item glyph_link chat_btn menu_btn" onclick="location='chat'">
              <span class="glyphicon glyphicon-comment"></span>
          </li>
          <li class="navbar_item glyph_link drive_btn menu_btn" onclick="location='drive'">
              <span class="glyphicon glyphicon-hdd"></span>
          </li>
          <li class="navbar_item glyph_link cal_btn menu_btn" onclick="location='cal'">
              <span class="glyphicon glyphicon-calendar"></span>
          </li>
          <li class="navbar_item glyph_link networks_btn menu_btn" onclick="location='networks'">
              <span class="glyphicon glyphicon-globe"></span>
          </li>
          <div class="navbar_item right_links">
            <li class="navbar_item glyph_link menu">
                <span class="glyphicon glyphicon-menu-hamburger"></span>
            </li>
            <li class="navbar_item glyph_link" id="notif_button">
                <span class="glyphicon glyphicon-inbox"></span>
            </li>
            <img class="profile_id" id="small_prof_pic" src="./images/user.jpg"></img>
            <span class="profile_name" id="name_link"></span>
          </div>
        </ul>
    </div>
    <div id="notif_drop" class="hidden">
      <ul>
        <li class="notif_list_item">hey</li>
        <li class="notif_list_item">hi</li>
        <li class="notif_list_item">ho</li>
      </ul>
    </div>
    <div id="prof_drop" class="hidden">
      <ul>
        <li class="notif_list_item" id="view_prof_button">View Profile and Settings</li>
        <li class="notif_list_item" id="logout_button">Log Out</li>
      </ul>
    </div>
    <div id="darken" class="hidden"></div>
    <!-- END OF NAVIGATION BAR -->

    <!-- BODY -->
    <div class="wide_body">
      <div class="general_info">
        <span class="team_head"><h1><%= teamName %><br/><h2>Team <%= teamNum %></h2></h1></span>
      </div>
      <div class="container-fluid">
        <div class=" members_list row">
          <% members.forEach(function(member) { %>
            <div class="col-sm-6 col-md-4 col-lg-3">
              <span data-userid="<%= member._id %>" class="user_display"><img src="<%= member.profpicpath %>-60" onerror="this.src='images/user.jpg'" id="small_prof_pic"></img>
                <span class="user_link_display"><%= member.firstname %> <%= member.lastname %></span>
                <% if(viewerIsAdmin){ %>
                  <span class="glyphicon glyphicon-trash delete_user "></span>
                <% } %>
              </span>
            </div>
          <% }); %>
      </div>
    </div>
    <!-- END OF BODY -->


    <script src="jbox/jBox.min.js"></script>
    <script type="text/javascript" src="js/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/velocity.min.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
        $(document).on("click", ".user_display", function(e){
          var a = $(e.target);
          var b = $(this).find(".delete_user");
          if (a[0] != b[0]){
            location="u/"+ $(this).attr("data-userid");
          }
        });
        $(document).on("click", ".delete_user", function(){
          if (window.confirm("Are you sure?")) {
            var $this = $(this);
            $.post("/f/removeUserFromTeam", {user_id: $this.parent().attr("data-userid")}, function(responseText){
              if(responseText == "success"){
                $this.parent().find("#small_prof_pic").remove();
                $this.parent().find(".user_link").html("Removed");
                $this.parent().css("background-color", "#FF6F6F")
                var delete_btn = $this;
                setTimeout(function(){
                  delete_btn.remove();
                }, 10)
              }else{
                alert(responseText);
              }
            })
          }
        })
      });
      window.onunload = function(){};
    </script>
  </body>
</html>
